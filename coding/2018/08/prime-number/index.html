<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>素数的一个判定定理 - Alvin&#39;s Blog</title>
    <meta property="og:title" content="素数的一个判定定理 - Alvin&#39;s Blog">
    

    
    <meta property="keywords" content ="prime, number,素数,素数判定,Wilson定理">
    

    <meta name="twitter:card" content="summary">
    
      
    

    
      
      <meta property="og:description" content="素数有一个判定定理，被称为 Wilson 定理：
[&amp;hellip;] 当且仅当 $p$ 是素数时，$(p-1)\ ! \equiv -1 \pmod{p}$
[&amp;hellip;] 这个定理的证明不是很容易想到，记录于此，以供参考。
在《费马小定理及其欧拉推广》一文中，我们已经知道：
[&amp;hellip;] 当 $a$ 与素数 $p$ 互素时，$a,\ 2a,\ \cdots,\ (p-1)a$ &amp;hellip;">
      
    

    
    

    
    <link rel="icon" href="/favicon.ico">
    

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />    
    
  </head>

  
  
  
  
  <body class="coding hide_scroll_bar">
    <header class="masthead">
      <h1><a href="/" style="border: none;"><img src="/images/logo.jpg" alt="Alvin Yih"></a></h1>



      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li>
    <a href="/">主页</a>
  </li>
  
  <li>
    <a href="/about/">关于</a>
  </li>
  
  <li class="active">
    <a href="/coding/">编程</a>
  </li>
  
  <li>
    <a href="/essay/">随笔</a>
  </li>
  
  <li>
    <a href="/donate/">捐赠</a>
  </li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      <h1>素数的一个判定定理</h1>

<h3>Alvin
  /  2018-08-31</h3>
<hr>
      </header>




<p>素数有一个判定定理，被称为 <a href="https://en.wikipedia.org/wiki/Wilson%27s_theorem">Wilson 定理</a>：</p>
<blockquote>
<p>当且仅当 $p$ 是素数时，$(p-1)\ ! \equiv -1 \pmod{p}$</p>
</blockquote>
<p>这个定理的证明不是很容易想到，记录于此，以供参考。</p>
<p>在《<a href="../fermat-theorem/">费马小定理及其欧拉推广</a>》一文中，我们已经知道：</p>
<blockquote>
<p>当 $a$ 与素数 $p$ 互素时，$a,\ 2a,\ \cdots,\ (p-1)a$ 这 $p-1$ 个数除以 $p$ 的余数恰好是 $1,\ 2,\ \cdots,\ p-1$.</p>
</blockquote>
<p>我们现在令 $1 \leqslant a \leqslant p-1$，显然 $a$ 与素数 $p$ 是互素的，因此上面的结论成立。这意味着：</p>
<blockquote>
<p>当 $p$ 是素数时，对任意 $1 \leqslant a \leqslant p-1$，存在一个数 $i$，$1 \leqslant i \leqslant p-1$，使得 $i \cdot a$ 除以 $p$ 的余数是 $1$，即 $i \cdot a \equiv 1 \pmod{p}$.</p>
</blockquote>
<p>考虑 $i = a$ 的情况：
$$a \cdot a \equiv 1 \pmod{p}$$</p>
<p>即 $p$ 整除 $(a+1)(a-1)$，只有 $a = p-1$ 与 $a = 1$ 时满足。因此，小于 $p$ 的正整数中，除了 $1$ 与 $p-1$ 之外，其余的数刚好两两配对，使得：</p>
<p>$$
i \cdot j \equiv 1 \pmod{p}
$$</p>
<p>再加上
$$1 \cdot (p-1) \equiv p-1 \pmod{p}$$</p>
<p>由同余乘法不难得到
$$1 \cdot 2 \cdots (p-1) \equiv p-1 \pmod{p}$$</p>
<p>即
$$(p-1)\ ! \equiv -1 \pmod{p}$$</p>
<p>反过来，当 $(p-1)\ ! \equiv -1 \pmod{p}$ 时，即有
$$(p-1)\ ! + 1 = kp$$</p>
<p>若 $p$ 不是素数，则 $p$ 有素因子 $q$，$q$ 必是 $1,\ 2,\ \cdots,\ (p-1)$ 中的一个，因此 $q$ 整除 $(p-1)\ !$，从而得到 $q$ 整除 $1$，矛盾。这样就证明了 $p$ 是素数。</p>


  <footer>
  



<nav class="fixed-nav">
  <span class="next">
    <a href=" /coding/2018/08/from-c-to-cpp/ ">&raquo;</a>
  </span>
</nav>
<nav class="post-nav">
  <ul>
     
    <li>
      <span class="prev">&rtrif; 上一篇 &emsp;</span>
      <a href="/coding/2018/09/vim/">无处不在的 vim</a>
    </li>
    
    
    <li>
      <span class="next">&rtrif; 下一篇 &emsp;</span>
      <a href="/coding/2018/08/from-c-to-cpp/">从 C 到 C&#43;&#43;</a>
    </li>
    
  </ul>
</nav>






<link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.6.2/gitalk.min.css">
<script src="//cdn.bootcss.com/gitalk/1.6.2/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '78371628e00f43aff18e',
    clientSecret: '6905d0b807b7008ea04b420bb9fd9a7f390ec400',
    repo: 'gitalk',
    owner: 'idealvin',
    admin: ['idealvin'],
    id: location.pathname,
    language: 'zh-CN',
    distractionFreeMode: false
  })
  
  gitalk.render('gitalk-container');
</script>



  

  
  <hr>
  <div class="copyright">©2018-2020 <a href="/">Alvin Yih</a> | <a href="https://github.com/idealvin">Github</a></div>
  
  </footer>
  
   <div class="cnzz">
<script type="text/javascript">
  document.write(unescape("%3Cspan id='cnzz_stat_icon_1279117347'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1279117347%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));
</script>
</div> 
  </article>
   <script type="text/javascript" async
        src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
    MathJax.Hub.Config({
        
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$']],
            processEscapes: true,
            processEnvironments: false,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i = 0; i < all.length; i += 1) {
            var x = all[i].SourceElement().parentNode.className;
            if (x == '') {
                all[i].SourceElement().parentNode.className += 'has-jax';
            } else if (x.indexOf('has-jax') == -1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        }
    });
</script>
 
  
  </body>
</html>

